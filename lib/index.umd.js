/**
 * @License
 * MIT License
 *
 * Copyright (c) 2018 George Gach
 * https://github.com/georgegach/k-closest
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.kc={})}(this,function(t){"use strict";function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(){function t(n){e(this,t),this.heap=[null],this.size=0,this.c=n||function(t,e){return e-t}}return i(t,[{key:"buildHeap",value:function(t){this.heap=t,this.size=t.length;for(var e=Math.floor(this.size/2)-1;e>=0;e--)this.heapify(e);return this}},{key:"push",value:function(t){var e=this.size++,n=this.heap;n[e]=t;for(var i=e-1>>1;e>0&&this.c(n[e],n[i])<0;){var r=n[i];n[i]=n[e],n[e]=r,e=i,i=i-1>>1}}},{key:"peek",value:function(){return this.heap[0]}},{key:"pop",value:function(){if(0===this.size)return null;var t=this.heap[0];return this.heap[0]=this.heap[--this.size],this.heap[this.size]=null,this.heapify(0),t}},{key:"toArray",value:function(t){for(var e=t||this.size,n=[],i=0;i<e;i++)n.push(this.pop());return n}},{key:"heapify",value:function(t){for(var e=this.heap,n=this.size;;){var i=1+(t<<1),r=i+1,u=t;if(i<n&&this.c(e[i],e[u])<0&&(u=i),r<n&&this.c(e[r],e[u])<0&&(u=r),u===t)break;var o=e[t];e[t]=e[u],e[u]=o,t=u}}}],[{key:"parent",value:function(t){return t-1>>1}},{key:"left",value:function(t){return 1+(t<<1)}},{key:"right",value:function(t){return 2+(t<<1)}}]),t}(),u=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function(){function t(e,i){n(this,t),this.list=Array.from(e),this.distanceFunction=i||this.recomendedDiff()}return u(t,[{key:"recomendedDiff",value:function(){var t=this.list[0];if("number"==typeof t)return function(t,e){return Math.abs(t-e)};if(void 0!==t.length){if("number"==typeof t[0])switch(t.length){case 2:return function(t,e){return Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)};case 3:return function(t,e){return Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)+Math.pow(t[2]-e[2],2)};default:return function(t,e){return t.reduce(function(t,n,i){return Math.pow(n-e[i],2)+t},0)}}}else if("r"in t&&"g"in t&&"b"in t)return function(t,e){return Math.pow(t.r-e.r,2)+Math.pow(t.g-e.g,2)+Math.pow(t.b-e.b,2)};throw"Could not recommend distance function"}},{key:"single",value:function(t){for(var e=this.distanceFunction,n=this.list[0],i=e(t,n),r=1;r<this.list.length;r++){var u=e(t,this.list[r]);u<i&&(n=this.list[r],i=u)}return n}},{key:"get",value:function(t,e){return 1===e||void 0===e?this.single(t):this.wHeap(t,e)}},{key:"wHeapSort",value:function(t,e){for(var n=this.distanceFunction,i=new r(function(e,i){return n(t,e)-n(t,i)}),u=0;u<this.list.length;u++)i.push(this.list[u]);return i.toArray(e)}},{key:"wBuildHeap",value:function(t,e){var n=this.distanceFunction;return new r(function(e,i){return n(t,e)-n(t,i)}).buildHeap(Array.from(this.list)).toArray(closestK)}},{key:"wSort",value:function(t,e){var n=this,i=function(e,i){return n.distanceFunction(t,e)-n.distanceFunction(t,i)};return Array.from(this.list).sort(i).slice(0,e)}},{key:"wBubble",value:function(t,e){var n,i,r,u,o=this,s=Array.from(this.list),a=this.list.length;for(i=0;i<e;i++){for(r=i,n=i+1;n<a;n++)(function(e,n){return o.distanceFunction(t,e)-o.distanceFunction(t,n)})(s[n],s[r])<0&&(r=n);r!=i&&(u=s[r],s[r]=s[i],s[i]=u)}return s.slice(0,e)}},{key:"wHeap",value:function(t,e){for(var n=this.distanceFunction,i=new r(function(e,i){return n(t,i)-n(t,e)}),u=0;u<e;u++)i.push(this.list[u]);for(var o=n(t,i.peek()),s=e;s<this.list.length;s++)n(t,this.list[s])<o&&(i.push(this.list[s]),i.pop(),o=n(t,i.peek()));return i.toArray().reverse()}}]),t}();t.default=o,t.Seeker=o,t.Heap=r,Object.defineProperty(t,"__esModule",{value:!0})});
